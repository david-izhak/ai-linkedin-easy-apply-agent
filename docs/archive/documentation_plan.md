# План технической документации для LinkedIn Easy Apply Bot

Этот документ описывает структуру и содержание полной технической документации для проекта. Цель — создать исчерпывающее руководство для разработчиков, которое упростит понимание, поддержку и дальнейшее развитие проекта.

## 1. Введение и обзор проекта

Этот раздел должен дать общее представление о проекте, его целях и основных возможностях. Информация будет частично взята из `README.md` и `structure.md`.

- **1.1. Назначение проекта:** Краткое описание того, что делает бот (автоматизация поиска и подачи заявок на LinkedIn).
- **1.2. Основные возможности:**
    - Поиск вакансий по гибким критериям (ключевые слова, география, тип занятости).
    - Интеллектуальная фильтрация с использованием LLM для оценки соответствия вакансии резюме.
    - Автоматическая генерация сопроводительных писем.
    - Резервная (fallback) фильтрация по ключевым словам.
    - Автоматическое заполнение форм "Easy Apply".
- **1.3. Технологический стек:** Перечень основных технологий и библиотек (Python, Playwright, SQLite, Pydantic, Langchain).
- **1.4. Основные этапы работы бота:** Описание трехфазного процесса: `Discovery`, `Enrichment`, `Processing`.

## 2. Архитектура приложения

Этот раздел должен подробно описать высокоуровневую архитектуру и структуру проекта, опираясь на `structure.md` и `ai_architecture.md`.

- **2.1. Структура директорий:** Детальное описание назначения каждой основной директории (`actions`, `core`, `llm`, `phases`, `apply_form`).
- **2.2. Точка входа и режимы работы:**
    - Описание `main.py` как оркестратора.
    - Описание режимов работы (`BOT_MODE`): `discovery`, `enrichment`, `processing`, `full_run`.
- **2.3. Схема взаимодействия компонентов:**
    - Диаграмма (в формате Mermaid), иллюстрирующая, как `main.py` вызывает фазы, которые в свою очередь используют `actions` и `core` модули.

    ```mermaid
    graph TD
        A[main.py] --> B{BOT_MODE?}
        B --> C[Discovery Phase]
        B --> D[Enrichment Phase]
        B --> E[Processing Phase]
        B --> F[Full Run]

        C --> G[actions.fetch_jobs]
        D --> G
        E --> H[llm.vacancy_filter]
        H -- Подходит --> I[llm.cover_letter_generator]
        I --> J[actions.apply]
        J --> K[apply_form.fill_fields]
        H -- Не подходит --> L[Статус: skipped]
        H -- Ошибка LLM --> M[Fallback-фильтрация]

        subgraph "Ядро"
            G & J & K & M --> N[core.database]
            G & J & K & M --> O[core.selectors]
            A & C & D & E --> P[core.logger]
        end
    ```

## 3. Описание компонентов и модулей

Детальное описание каждого модуля.

- **3.1. `core/` - Ядро:**
    - `database.py`: CRUD-операции, схема таблиц.
    - `selectors.py`: Роль в отделении логики от UI-селекторов.
    - `logger.py`: Конфигурация логирования.
- **3.2. `actions/` - Действия:**
    - `login.py`: Логика входа.
    - `fetch_jobs.py`: Скрейпинг вакансий.
    - `apply.py`: Процесс подачи заявки.
- **3.3. `phases/` - Фазы:**
    - `discovery.py`, `enrichment.py`, `processing.py`: Логика каждой фазы, переходы статусов вакансий.
- **3.4. `apply_form/` - Заполнение форм:**
    - `fill_fields.py`: Оркестратор.
    - Описание специализированных модулей для разных типов полей.

## 4. Интеграция с LLM

Один из самых важных разделов, основанный на `ai_architecture.md`.

- **4.1. Архитектура модуля `llm/`:**
    - Описание каждого файла (`llm_client.py`, `client_factory.py`, `vacancy_filter.py` и т.д.).
- **4.2. Процесс фильтрации вакансий:**
    - Пошаговое описание: от вызова `is_vacancy_suitable` до получения ответа от LLM.
    - Устойчивый парсинг JSON-ответа.
    - Логика fallback-фильтрации при ошибках.
- **4.3. Процесс генерации сопроводительных писем:**
    - Пошаговое описание.
- **4.4. Промпты:**
    - Примеры и назначение ключевых промптов из `prompts.py`.
- **4.5. Конфигурация LLM:**
    - Описание всех переменных окружения, связанных с LLM.

## 5. Схема базы данных

Подробное описание таблиц, их полей и связей. Информация взята из `core/database.py` и `structure.md`.

- **5.1. Таблица `vacancies`:**
    - Описание каждого поля.
    - Жизненный цикл статусов (`status`): `discovered` -> `enriched` -> `applied` / `skipped_filter` / `error`.
- **5.2. Таблица `run_history`:**
    - Назначение таблицы.

## 6. Конфигурация и запуск

- **6.1. Установка и зависимости:**
    - Инструкции из `README.md`.
- **6.2. Файлы конфигурации:**
    - `config.py`: Описание ключевых параметров (поиск, данные для форм, фильтры).
    - `.env`: Роль в конфигурации LLM-модуля.
- **6.3. Запуск приложения:**
    - Команды для запуска в разных режимах (dry run vs. submit).

## 7. Тестирование

Объединение и структурирование информации из `test-structure-updated.md` и `test-structure-updated-2.md`.

- **7.1. Структура тестов:**
    - Разделение на `unit` и `integration` тесты.
- **7.2. Unit-тесты:**
    - Что покрывают, примеры.
- **7.3. Интеграционные тесты:**
    - Что покрывают, примеры.
    - Описание использования фикстур (in-memory DB, HTML-файлы).
- **7.4. Запуск тестов:**
    - Команды для запуска unit и integration тестов.
- **7.5. Рекомендации и известные проблемы:**
    - Обобщение рекомендаций из `test-structure-updated-2.md`.

## 8. Руководство по контрибьюции

Новый раздел, который поможет будущим разработчикам.

- **8.1. Code Style:**
    - Ссылка на `.flake8` и другие стандарты.
- **8.2. Как добавить новый тип поля в форму:**
    - Пошаговая инструкция.
- **8.3. Как добавить поддержку нового LLM-провайдера:**
    - Инструкция по расширению `LLMClient`.
- **8.4. Процесс внесения изменений (Pull Request Workflow).**
